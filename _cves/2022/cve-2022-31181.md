---
layout: "post"
cve_id: "CVE-2022-31181"
title: "PrestaShop - SQL Injection to Eval Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-31181.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-31181.yaml"
author: "daffainfo"
severity: "critical"
remediation: "Upgrade to version 1.7.8.7 or later. Alternatively, delete the MySQL Smarty cache feature if upgrade is not possible.
"
impact: "Attackers can execute arbitrary PHP code, leading to remote code execution and full system compromise
"
reference:
  - "https://www.xmco.fr/wp-content/uploads/2022/12/XMCO-ActuSecu-59-Forwardshell-UXSS-cyberguerre.pdf"
  - "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-hrgx-p36p-89q4"
  - "https://github.com/PrestaShop/PrestaShop/commit/b6d96e7c2a4e35a44e96ffbcdfd34439b56af804"
  - "https://nvd.nist.gov/vuln/detail/CVE-2025-27007"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2022-31181"
  epss-score: 0.70197
  epss-percentile: 0.98605
  cwe-id: "CWE-89,CWE-74"
  cpe: "cpe:2.3:a:prestashop:prestashop:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  vendor: "prestashop"
  product: "prestashop"
  shodan-query: ['http.component:"Prestashop"', 'cpe:"cpe:2.3:a:prestashop:prestashop"', 'http.component:"prestashop"']
tags:
  - "cve"
  - "cve2022"
  - "prestashop"
  - "rce"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
PrestaShop versions from 1.6.0.10 and before 1.7.8.7 contain an SQL injection caused by unsanitized user input, letting attackers chain the vulnerability to call PHP's Eval function, exploit requires attacker to send malicious input.


## üåê HTTP Request
```nohighlight
POST /login?create_account=1 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:105.0) Gecko/20100101 Firefox/105.0
Connection: close
Content-Length: 134
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

id_gender=1&firstname=zcrh&lastname=qwda&email=wKgjCC@livzj.com&password=wFPW1OGX&birthday=&customer_privacy=1&psgdpr=1&submitCreate=1
```


