---
layout: "post"
cve_id: "CVE-2024-43425"
title: "Moodle - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-43425.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-43425.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
reference:
  - "https://github.com/RedTeamPentesting/moodle-rce-calculatedquestions"
  - "https://blog.redteam-pentesting.de/2024/moodle-rce/"
  - "https://www.redteam-pentesting.de/en/advisories/rt-sa-2024-009/"
  - "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43425"
classification:
  cvss-score: 9.8
  cve-id: "CVE-2024-43425"
  epss-score: 0.90075
  epss-percentile: 0.99552
  cpe: "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 1
  shodan-query: "title:\"Moodle\""
  product: "moodle"
  vendor: "moodle"
tags:
  - "cve"
  - "cve2024"
  - "moodile"
  - "rce"
  - "authenticated"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
Attackers with the permission to create or modify questions in Moodle courses are able to craft malicious inputs for calculated questions, which can be abused to execute arbitrary commands on the underlying system.


## üåê HTTP Request
```nohighlight
GET /login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0
Connection: close
Content-Length: 73
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

anchor=&logintoken=Qz5fLGnoWebAKnx8rN5q&username=pZCEov&password=DDyOoyXv
```


