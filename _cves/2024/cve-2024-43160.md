---
layout: "post"
cve_id: "CVE-2024-43160"
title: "BerqWP <= 1.7.6 - Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2024/CVE-2024-43160.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2024/CVE-2024-43160.yaml"
author: "s4e-io"
severity: "critical"
reference:
  - "https://github.com/KTN1990/CVE-2024-43160"
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-43160"
  - "https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/searchpro/berqwp-176-unauthenticated-arbitrary-file-uplaod"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
  cvss-score: 10
  cve-id: "CVE-2024-43160"
  cwe-id: "CWE-434"
  epss-score: 0.84027
  epss-percentile: 0.99256
metadata:
  verified: True
  max-request: 3
  vendor: "BerqWP"
  product: "BerqWP"
  framework: "wordpress"
  publicwww-query: "/wp-content/plugins/searchpro"
tags:
  - "cve"
  - "cve2024"
  - "file-upload"
  - "shell"
  - "intrusive"
  - "wp"
  - "wp-plugin"
  - "wordpress"
  - "searchpro"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
The BerqWP Automated All-In-One PageSpeed Optimization Plugin for Core Web Vitals, Cache, CDN, Images, CSS, and JavaScript plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the /api/store_webp.php file in all versions up to, and including, 1.7.6. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## ðŸŒ HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/601.4.4 (KHTML, like Gecko) Version/9.0.3 Safari/537.86.4
Connection: close
Accept-Encoding: gzip
```


