---
layout: "post"
cve_id: "CVE-2023-26035"
title: "ZoneMinder Snapshots - Command Injection"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-26035.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-26035.yaml"
author: "Unblvr1,whotwagner"
severity: "critical"
remediation: "This issue is fixed in This issue is fixed in versions 1.36.33 and 1.37.33."
reference:
  - "https://www.rapid7.com/db/modules/exploit/unix/webapp/zoneminder_snapshots/"
  - "https://github.com/ZoneMinder/zoneminder/security/advisories/GHSA-72rg-h4vf-29gr"
  - "https://packetstormsecurity.com/files/175675/ZoneMinder-Snapshots-Command-Injection.html"
  - "https://github.com/rvizx/CVE-2023-26035"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-26035"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2023-26035"
  cwe-id: "CWE-862"
  epss-score: 0.49843
  epss-percentile: 0.97674
  cpe: "cpe:2.3:a:zoneminder:zoneminder:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 2
  vendor: "zoneminder"
  product: "zoneminder"
  shodan-query: ['html:"ZM - Login"', 'http.html:"zm - login"']
  fofa-query: "body=\"zm - login\""
tags:
  - "cve"
  - "cve2023"
  - "rce"
  - "zoneminder"
  - "unauth"
  - "packetstorm"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
ZoneMinder is a free, open source Closed-circuit television software application for Linux which supports IP, USB and Analog cameras.Versions prior to 1.36.33 and 1.37.33 are vulnerable to Unauthenticated Remote Code Execution via Missing Authorization. There are no permissions check on the snapshot action, which expects an id to fetch an existing monitor but can be passed an object to create a new one instead. TriggerOn ends up calling shell_exec using the supplied Id.


## üåê HTTP Request
```nohighlight
GET /index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/601.1.56 (KHTML, like Gecko) Version/9.0 Safari/601.1.56
Connection: close
Accept-Encoding: gzip
```


